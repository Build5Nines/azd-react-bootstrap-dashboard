# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json
name: build5nines/azd-react-bootstrap-dashboard
metadata:
  template: build5nines/azd-react-bootstrap-dashboard@1.0.0

infra:
  provider: bicep

services:
  # Dashboard App
  dashboard:
    project: ./src/dashboard  # Path to the project folder
    host: staticwebapp        # Static Web App service
    language: js              # JavaScript
    dist: build               # Build output folder
    hooks:
      prepackage:
        posix:                            # Optional hook to run React build before deployment
          shell: sh
          run: npm install && npm run build
        windows:
          shell: pwsh
          run: npm install; npm run build

  # API App
  api:
    project: ./src/api                    # Path to Node.js API project
    host: appservice                      # Host on Azure App Service
    language: js                          # Language: JavaScript
    hooks:
      prepackage:                         # Hook to install dependencies before deployment
        posix:
          shell: sh
          run: npm install
        windows:
          shell: pwsh
          run: npm install
